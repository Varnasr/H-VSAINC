<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyderabad District Electoral Analysis 1999-2023</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: white;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 10px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .metadata {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            font-size: 1.8em;
        }
        
        .section h3 {
            color: #764ba2;
            margin: 20px 0 15px 0;
            font-size: 1.4em;
        }
        
        .chart-container {
            position: relative;
            margin: 30px 0;
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 600px;
            margin-bottom: 20px;
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #48bb78;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(72, 187, 120, 0.3);
        }
        
        .btn-export {
            background: #ed8936;
            color: white;
        }
        
        .btn-export:hover {
            background: #dd6b20;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(237, 137, 54, 0.3);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background: #f7fafc;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            color: white;
            font-size: 1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .stat-card .value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .insight-box {
            background: #edf2f7;
            border-left: 4px solid #48bb78;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .insight-box h4 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .methodology {
            background: #fff5f5;
            border-left: 4px solid #f56565;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            background: #2d3748;
            color: white;
            margin-top: 40px;
            border-radius: 8px;
        }
        
        @media print {
            .export-buttons {
                display: none;
            }
            .section {
                page-break-inside: avoid;
            }
            .container {
                max-width: 100%;
                padding: 10px;
            }
            .chart-wrapper {
                height: 700px !important;
                width: 100% !important;
                page-break-inside: avoid;
                margin: 20px 0;
            }
            .chart-wrapper canvas {
                max-width: 100% !important;
                height: auto !important;
            }
            .chart-container {
                width: 100% !important;
                page-break-inside: avoid;
                padding: 15px;
            }
            body {
                width: 100%;
            }
            table {
                font-size: 9px;
            }
            th, td {
                padding: 5px;
            }
            @page {
                size: A4;
                margin: 15mm;
            }
        }
        
        .highlight {
            background: #fef5e7;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
        
        .party-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 2px;
        }
        
        .badge-aimim { background: #16a34a; color: white; }
        .badge-tdp { background: #eab308; color: black; }
        .badge-mbt { background: #dc2626; color: white; }
        .badge-inc { background: #0ea5e9; color: white; }
        .badge-bjp { background: #f97316; color: white; }
        .badge-trs { background: #ec4899; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Electoral Analysis: Hyderabad District</h1>
            <p>Assembly Elections 1999-2023 | Comprehensive Political Economy Analysis</p>
        </div>
        
        <div class="metadata">
            <h3>Report Metadata</h3>
            <p><strong>Analysis Period:</strong> 1999-2023 (6 Election Cycles)</p>
            <p><strong>Geographic Coverage:</strong> Hyderabad District Constituencies</p>
            <p><strong>Constituencies Analyzed:</strong> Chandrayangutta, Charminar, Malakpet, Yakutpura, Bahadurpura</p>
            <p><strong>Political Parties:</strong> AIMIM, TDP, MBT, INC, BJP, TRS/BRS</p>
            <p><strong>Report Generated:</strong> <span id="reportDate"></span></p>
            <p><strong>Methodology:</strong> Quantitative analysis of vote share trends, constituency-level comparative analysis, party performance metrics</p>
        </div>

        <div class="export-buttons" style="margin-bottom: 20px;">
            <button class="btn btn-export" onclick="exportToPDF()">📄 Export Full Report to PDF</button>
            <button class="btn btn-secondary" onclick="exportAllDataToCSV()">📊 Export All Data to CSV</button>
        </div>
        
        <div class="methodology" style="margin-bottom: 20px;">
            <h4>📋 PDF Export Instructions</h4>
            <p><strong>For best results:</strong> When the print dialog opens, select "Save as PDF" and set the following:</p>
            <ul style="margin-left: 20px; margin-top: 5px;">
                <li>Paper size: A4 or Letter</li>
                <li>Margins: Default or Minimum</li>
                <li>Scale: 100% (or adjust to fit)</li>
                <li>Background graphics: Enabled (to include colors and charts)</li>
            </ul>
        </div>

        <!-- Executive Summary -->
        <div class="section" id="executive-summary">
            <h2>Executive Summary</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Time Period</h3>
                    <div class="value">24</div>
                    <div class="label">Years Analyzed</div>
                </div>
                <div class="stat-card">
                    <h3>Election Cycles</h3>
                    <div class="value">6</div>
                    <div class="label">Assembly Elections</div>
                </div>
                <div class="stat-card">
                    <h3>Constituencies</h3>
                    <div class="value">5</div>
                    <div class="label">Assembly Segments</div>
                </div>
                <div class="stat-card">
                    <h3>Political Parties</h3>
                    <div class="value">6</div>
                    <div class="label">Major Players</div>
                </div>
            </div>
            
            <h3>Key Findings</h3>
            <div class="insight-box">
                <h4>🎯 AIMIM Dominance Pattern</h4>
                <p>AIMIM demonstrates consistent electoral dominance in Hyderabad constituencies, with vote shares ranging from 30.44% to 78.46%. The party shows particularly strong performance in Bahadurpura (2014: 78.46%, 2018: 74.26%) and Charminar constituencies.</p>
            </div>
            
            <div class="insight-box">
                <h4>📊 INC Performance Dynamics</h4>
                <p>The Indian National Congress shows variable performance with notable strength in Malakpet (2004: 52.12%, 2023: 22.5%). As documented in the supplementary analysis, the 2004 spike in Malakpet occurred due to AIMIM not fielding a candidate, leading to temporary vote consolidation. Recent elections (2018-2023) show modest INC recovery across constituencies.</p>
            </div>
            
            <div class="insight-box">
                <h4>⚡ BJP Growth Trajectory</h4>
                <p>BJP demonstrates significant growth from marginal presence in 1999 to competitive positions in recent elections, particularly in Malakpet (2014: 28.61%) and Charminar (2023: 26.8%), indicating changing electoral dynamics.</p>
            </div>
            
            <div class="insight-box">
                <h4>🔄 Multi-Party Competition</h4>
                <p>The electoral landscape shows increasing multi-party competition with TRS/BRS emerging as a significant player post-2014, and MBT maintaining presence in specific constituencies, particularly Yakutpura.</p>
            </div>
        </div>

        <!-- Data Table -->
        <div class="section" id="data-section">
            <h2>Complete Electoral Data</h2>
            <div class="export-buttons">
                <button class="btn btn-secondary" onclick="exportTableToCSV('dataTable', 'electoral_data.csv')">📊 Export Table to CSV</button>
            </div>
            <div style="overflow-x: auto;">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>Year</th>
                            <th>Constituency</th>
                            <th>AIMIM %</th>
                            <th>TDP %</th>
                            <th>MBT %</th>
                            <th>INC %</th>
                            <th>BJP %</th>
                            <th>TRS %</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Party Performance Over Time -->
        <div class="section" id="party-trends">
            <h2>Party-wise Performance Trends</h2>
            <div class="chart-container">
                <h3>AIMIM Vote Share Evolution (1999-2023)</h3>
                <div class="chart-wrapper">
                    <canvas id="aimim-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('aimim-chart', 'AIMIM_Trends.png')">🖼️ Export to PNG</button>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>INC Vote Share Trajectory (1999-2023)</h3>
                <div class="chart-wrapper">
                    <canvas id="inc-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('inc-chart', 'INC_Trends.png')">🖼️ Export to PNG</button>
                </div>
                <div class="methodology">
                    <h4>📌 Important Context: Malakpet 2004 Anomaly</h4>
                    <p>The sharp increase in INC's vote share in Malakpet during 2004 (52.12%) occurred because AIMIM did not field a candidate in that election, leading to a temporary consolidation of votes towards INC. This represents a structural anomaly rather than genuine INC strength in that constituency.</p>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>BJP Growth Pattern (1999-2023)</h3>
                <div class="chart-wrapper">
                    <canvas id="bjp-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('bjp-chart', 'BJP_Trends.png')">🖼️ Export to PNG</button>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>TRS/BRS Emergence (2004-2023)</h3>
                <div class="chart-wrapper">
                    <canvas id="trs-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('trs-chart', 'TRS_Trends.png')">🖼️ Export to PNG</button>
                </div>
            </div>
        </div>

        <!-- Constituency Analysis -->
        <div class="section" id="constituency-analysis">
            <h2>Constituency-Level Analysis</h2>
            
            <div class="chart-container">
                <h3>Comparative Party Performance by Constituency (2023)</h3>
                <div class="chart-wrapper">
                    <canvas id="constituency-comparison"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('constituency-comparison', 'Constituency_Comparison_2023.png')">🖼️ Export to PNG</button>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>AIMIM Dominance Across Constituencies</h3>
                <div class="chart-wrapper">
                    <canvas id="aimim-constituency"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('aimim-constituency', 'AIMIM_by_Constituency.png')">🖼️ Export to PNG</button>
                </div>
            </div>
        </div>

        <!-- Statistical Analysis -->
        <div class="section" id="statistical-analysis">
            <h2>Statistical Analysis</h2>
            
            <h3>Vote Share Volatility Analysis</h3>
            <div class="chart-container">
                <h3>Standard Deviation of Vote Shares (Measure of Electoral Volatility)</h3>
                <div class="chart-wrapper">
                    <canvas id="volatility-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('volatility-chart', 'Vote_Share_Volatility.png')">🖼️ Export to PNG</button>
                </div>
            </div>
            
            <h3>Average Vote Share by Party (1999-2023)</h3>
            <div id="avg-stats"></div>
            
            <h3>Growth Rate Analysis</h3>
            <div class="chart-container">
                <h3>Vote Share Change: 1999 vs 2023</h3>
                <div class="chart-wrapper">
                    <canvas id="growth-chart"></canvas>
                </div>
                <div class="export-buttons">
                    <button class="btn btn-primary" onclick="exportChartToPNG('growth-chart', 'Growth_Analysis.png')">🖼️ Export to PNG</button>
                </div>
            </div>
        </div>

        <!-- Interpretation and Insights -->
        <div class="section" id="interpretation">
            <h2>Political Economy Interpretation</h2>
            
            <h3>1. Electoral Stability and Party Systems</h3>
            <p>The Hyderabad constituencies exhibit characteristics of a <span class="highlight">dominant party system</span> with AIMIM maintaining consistent electoral superiority across most constituencies. This pattern suggests:</p>
            <ul style="margin-left: 30px; margin-top: 10px;">
                <li><strong>Identity-based Voting:</strong> Strong community consolidation leading to stable vote banks</li>
                <li><strong>Institutional Incumbency:</strong> AIMIM's organizational strength and local governance experience</li>
                <li><strong>Fragmented Opposition:</strong> Multiple opposition parties splitting anti-incumbency votes</li>
            </ul>
            
            <h3>2. Emerging Competition Dynamics</h3>
            <p>The data reveals <span class="highlight">increasing competitive pressure</span> from BJP and TRS/BRS in recent elections:</p>
            <ul style="margin-left: 30px; margin-top: 10px;">
                <li><strong>BJP Growth:</strong> Systematic expansion from negligible presence (1999) to 15-27% vote share in multiple constituencies (2023)</li>
                <li><strong>TRS/BRS Entry:</strong> Post-2014 emergence as a significant player, particularly in constituencies like Bahadurpura (15.6% in 2023) and Yakutpura (15.95% in 2018)</li>
                <li><strong>TDP Decline:</strong> Systematic erosion from competitive positions (1999-2009) to marginal or no presence in recent elections</li>
            </ul>
            
            <h3>3. INC Performance: Electoral Trajectory</h3>
            <p>The Congress party's trajectory demonstrates <span class="highlight">distinct electoral patterns</span>:</p>
            <ul style="margin-left: 30px; margin-top: 10px;">
                <li><strong>Variable Performance:</strong> High volatility across constituencies with fluctuating vote shares</li>
                <li><strong>Multi-Party Competition:</strong> Operating within a fragmented opposition landscape alongside BJP, TRS/BRS, and regional parties</li>
                <li><strong>Contextual Gains:</strong> The 2004 Malakpet spike (52.12%) represents a structural anomaly due to AIMIM's absence rather than baseline performance</li>
                <li><strong>Recent Performance:</strong> 2023 shows notable presence in key constituencies (Malakpet: 22.5%, Charminar: 11.1%, Bahadurpura: 10.1%)</li>
            </ul>
            
            <h3>4. Constituency-Specific Patterns</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Bahadurpura</h3>
                    <p style="font-size: 0.9em;">AIMIM fortress with 62-78% vote share. Minimal opposition competitiveness.</p>
                </div>
                <div class="stat-card">
                    <h3>Chandrayangutta</h3>
                    <p style="font-size: 0.9em;">Consistent AIMIM dominance (59-68%). Growing BJP-TRS challenge in recent cycles.</p>
                </div>
                <div class="stat-card">
                    <h3>Charminar</h3>
                    <p style="font-size: 0.9em;">Most competitive constituency. AIMIM declining from 66% (1999) to 50% (2023). BJP emerging strong (26.8% in 2023).</p>
                </div>
                <div class="stat-card">
                    <h3>Malakpet</h3>
                    <p style="font-size: 0.9em;">Highest volatility. Multi-party competition with AIMIM, BJP, INC, and TDP all competitive at different points.</p>
                </div>
                <div class="stat-card">
                    <h3>Yakutpura</h3>
                    <p style="font-size: 0.9em;">AIMIM stronghold showing recent vulnerability. Significant vote share decline (57% in 2004 to 33% in 2023).</p>
                </div>
            </div>
            
            <h3>5. Implications for Electoral Competition</h3>
            <div class="insight-box">
                <h4>🔍 Key Takeaways for Political Analysis</h4>
                <p><strong>Electoral Realignment:</strong> The period 2014-2023 marks a significant realignment with BJP emergence and TRS/BRS entry changing traditional two-party (AIMIM-TDP) dynamics.</p>
                <p><strong>Opposition Fragmentation:</strong> Multiple opposition parties (BJP, INC, TRS, TDP) compete for anti-incumbency votes, benefiting AIMIM through vote splitting.</p>
                <p><strong>Changing Demographics:</strong> Declining AIMIM margins in constituencies like Yakutpura and Charminar may indicate demographic shifts or changing voter preferences.</p>
                <p><strong>National vs Regional Dynamics:</strong> BJP's growth reflects national political trends penetrating traditional regional strongholds.</p>
            </div>
        </div>

        <div class="footer">
            <p>Electoral Analysis Report | Hyderabad District 1999-2023</p>
            <p>Generated using official election data | All vote shares in percentages</p>
            <p style="margin-top: 10px; font-size: 0.9em;">For academic and research purposes</p>
        </div>
    </div>

    <script>
        // Data
        const electionData = [
            {YEAR: 1999, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 34.87, TDP_VoteShare: 27.95, MBT_VoteShare: 28.64, INC_VoteShare: 4.86, BJP_VoteShare: null, TRS_VoteShare: null},
            {YEAR: 1999, ACNAME: "CHARMINAR", AIMIM_VoteShare: 66.15, TDP_VoteShare: 17.39, MBT_VoteShare: 7.41, INC_VoteShare: 6.96, BJP_VoteShare: null, TRS_VoteShare: null},
            {YEAR: 1999, ACNAME: "MALAKPET", AIMIM_VoteShare: null, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 31.16, BJP_VoteShare: 53.24, TRS_VoteShare: null},
            {YEAR: 1999, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 48.07, TDP_VoteShare: null, MBT_VoteShare: 25.35, INC_VoteShare: 3.14, BJP_VoteShare: 19.02, TRS_VoteShare: null},
            {YEAR: 2004, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 42.45, TDP_VoteShare: 13.11, MBT_VoteShare: 33.78, INC_VoteShare: 8.33, BJP_VoteShare: null, TRS_VoteShare: 0.53},
            {YEAR: 2004, ACNAME: "CHARMINAR", AIMIM_VoteShare: 73.52, TDP_VoteShare: 12.9, MBT_VoteShare: 2.61, INC_VoteShare: 9.06, BJP_VoteShare: null, TRS_VoteShare: null},
            {YEAR: 2004, ACNAME: "MALAKPET", AIMIM_VoteShare: null, TDP_VoteShare: 43.35, MBT_VoteShare: null, INC_VoteShare: 52.12, BJP_VoteShare: null, TRS_VoteShare: null},
            {YEAR: 2004, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 57.54, TDP_VoteShare: null, MBT_VoteShare: 17.86, INC_VoteShare: 8.13, BJP_VoteShare: 15.51, TRS_VoteShare: 0.96},
            {YEAR: 2009, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 46.59, TDP_VoteShare: null, MBT_VoteShare: 31.05, INC_VoteShare: 8.07, BJP_VoteShare: 5.49, TRS_VoteShare: 1.01},
            {YEAR: 2009, ACNAME: "CHARMINAR", AIMIM_VoteShare: 48.61, TDP_VoteShare: 36.72, MBT_VoteShare: null, INC_VoteShare: 6.33, BJP_VoteShare: 4.72, TRS_VoteShare: null},
            {YEAR: 2009, ACNAME: "MALAKPET", AIMIM_VoteShare: 30.44, TDP_VoteShare: 22.18, MBT_VoteShare: null, INC_VoteShare: 18.01, BJP_VoteShare: 16.78, TRS_VoteShare: null},
            {YEAR: 2009, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 53.82, TDP_VoteShare: null, MBT_VoteShare: 16.06, INC_VoteShare: 10.44, BJP_VoteShare: 6.04, TRS_VoteShare: null},
            {YEAR: 2014, ACNAME: "BAHADURPURA", AIMIM_VoteShare: 78.46, TDP_VoteShare: 8.68, MBT_VoteShare: 1.86, INC_VoteShare: 3.57, BJP_VoteShare: null, TRS_VoteShare: 2.73},
            {YEAR: 2014, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 59.19, TDP_VoteShare: 12.8, MBT_VoteShare: 15.55, INC_VoteShare: 3.77, BJP_VoteShare: null, TRS_VoteShare: 5.36},
            {YEAR: 2014, ACNAME: "CHARMINAR", AIMIM_VoteShare: 57.11, TDP_VoteShare: 23.89, MBT_VoteShare: 2.04, INC_VoteShare: 5.08, BJP_VoteShare: null, TRS_VoteShare: 7.51},
            {YEAR: 2014, ACNAME: "MALAKPET", AIMIM_VoteShare: 47.24, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 6.66, BJP_VoteShare: 28.61, TRS_VoteShare: 9.11},
            {YEAR: 2014, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 45.84, TDP_VoteShare: null, MBT_VoteShare: 19.75, INC_VoteShare: 4.53, BJP_VoteShare: 22.23, TRS_VoteShare: 5.39},
            {YEAR: 2018, ACNAME: "BAHADURPURA", AIMIM_VoteShare: 74.26, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 5.49, BJP_VoteShare: 5.66, TRS_VoteShare: 11.08},
            {YEAR: 2018, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 67.95, TDP_VoteShare: null, MBT_VoteShare: 0.36, INC_VoteShare: 8.06, BJP_VoteShare: 10.75, TRS_VoteShare: 10.14},
            {YEAR: 2018, ACNAME: "CHARMINAR", AIMIM_VoteShare: 53.36, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 16.76, BJP_VoteShare: 21.04, TRS_VoteShare: 6.17},
            {YEAR: 2018, ACNAME: "MALAKPET", AIMIM_VoteShare: 42.86, TDP_VoteShare: 23.95, MBT_VoteShare: null, INC_VoteShare: null, BJP_VoteShare: 16.8, TRS_VoteShare: 13.76},
            {YEAR: 2018, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 49.07, TDP_VoteShare: null, MBT_VoteShare: 14.96, INC_VoteShare: 4.55, BJP_VoteShare: 11.71, TRS_VoteShare: 15.95},
            {YEAR: 2023, ACNAME: "BAHADURPURA", AIMIM_VoteShare: 62.02, TDP_VoteShare: null, MBT_VoteShare: 2, INC_VoteShare: 10.1, BJP_VoteShare: 8.1, TRS_VoteShare: 15.6},
            {YEAR: 2023, ACNAME: "CHANDRAYANGUTTA", AIMIM_VoteShare: 64.9, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 9.5, BJP_VoteShare: 10.7, TRS_VoteShare: 11.8},
            {YEAR: 2023, ACNAME: "CHARMINAR", AIMIM_VoteShare: 50.1, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 11.1, BJP_VoteShare: 26.8, TRS_VoteShare: 9.1},
            {YEAR: 2023, ACNAME: "MALAKPET", AIMIM_VoteShare: 42.3, TDP_VoteShare: null, MBT_VoteShare: null, INC_VoteShare: 22.5, BJP_VoteShare: 18.01, TRS_VoteShare: 14.1},
            {YEAR: 2023, ACNAME: "YAKUTPURA", AIMIM_VoteShare: 32.9, TDP_VoteShare: null, MBT_VoteShare: 32.2, INC_VoteShare: 5, BJP_VoteShare: 15.9, TRS_VoteShare: null}
        ];

        // Set report date
        document.getElementById('reportDate').textContent = new Date().toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });

        // Populate data table
        const tbody = document.getElementById('dataTableBody');
        electionData.forEach(row => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${row.YEAR}</td>
                <td>${row.ACNAME}</td>
                <td>${row.AIMIM_VoteShare !== null ? row.AIMIM_VoteShare.toFixed(2) : '-'}</td>
                <td>${row.TDP_VoteShare !== null ? row.TDP_VoteShare.toFixed(2) : '-'}</td>
                <td>${row.MBT_VoteShare !== null ? row.MBT_VoteShare.toFixed(2) : '-'}</td>
                <td>${row.INC_VoteShare !== null ? row.INC_VoteShare.toFixed(2) : '-'}</td>
                <td>${row.BJP_VoteShare !== null ? row.BJP_VoteShare.toFixed(2) : '-'}</td>
                <td>${row.TRS_VoteShare !== null ? row.TRS_VoteShare.toFixed(2) : '-'}</td>
            `;
            tbody.appendChild(tr);
        });

        // Chart colors
        const colors = {
            aimim: '#16a34a',
            tdp: '#eab308',
            mbt: '#dc2626',
            inc: '#0ea5e9',
            bjp: '#f97316',
            trs: '#ec4899'
        };

        // Helper function to get constituency data by party
        function getPartyDataByConstituency(party) {
            const constituencies = [...new Set(electionData.map(d => d.ACNAME))].sort();
            const years = [1999, 2004, 2009, 2014, 2018, 2023];
            
            return constituencies.map(constituency => {
                return {
                    constituency: constituency,
                    data: years.map(year => {
                        const entry = electionData.find(d => d.YEAR === year && d.ACNAME === constituency);
                        return entry ? entry[party] : null;
                    })
                };
            });
        }

        // AIMIM Chart
        const aimimData = getPartyDataByConstituency('AIMIM_VoteShare');
        new Chart(document.getElementById('aimim-chart'), {
            type: 'line',
            data: {
                labels: [1999, 2004, 2009, 2014, 2018, 2023],
                datasets: aimimData.map(d => ({
                    label: d.constituency,
                    data: d.data,
                    borderWidth: 3,
                    tension: 0.4,
                    fill: false
                }))
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: false
                    },
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        title: {
                            display: true,
                            text: 'Vote Share (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Election Year'
                        }
                    }
                }
            }
        });

        // INC Chart
        const incData = getPartyDataByConstituency('INC_VoteShare');
        new Chart(document.getElementById('inc-chart'), {
            type: 'line',
            data: {
                labels: [1999, 2004, 2009, 2014, 2018, 2023],
                datasets: incData.map(d => ({
                    label: d.constituency,
                    data: d.data,
                    borderWidth: 3,
                    tension: 0.4,
                    fill: false
                }))
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 60,
                        title: {
                            display: true,
                            text: 'Vote Share (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Election Year'
                        }
                    }
                }
            }
        });

        // BJP Chart
        const bjpData = getPartyDataByConstituency('BJP_VoteShare');
        new Chart(document.getElementById('bjp-chart'), {
            type: 'line',
            data: {
                labels: [1999, 2004, 2009, 2014, 2018, 2023],
                datasets: bjpData.map(d => ({
                    label: d.constituency,
                    data: d.data,
                    borderWidth: 3,
                    tension: 0.4,
                    fill: false
                }))
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 60,
                        title: {
                            display: true,
                            text: 'Vote Share (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Election Year'
                        }
                    }
                }
            }
        });

        // TRS Chart
        const trsData = getPartyDataByConstituency('TRS_VoteShare');
        new Chart(document.getElementById('trs-chart'), {
            type: 'line',
            data: {
                labels: [1999, 2004, 2009, 2014, 2018, 2023],
                datasets: trsData.map(d => ({
                    label: d.constituency,
                    data: d.data,
                    borderWidth: 3,
                    tension: 0.4,
                    fill: false
                }))
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 20,
                        title: {
                            display: true,
                            text: 'Vote Share (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Election Year'
                        }
                    }
                }
            }
        });

        // Constituency Comparison 2023
        const data2023 = electionData.filter(d => d.YEAR === 2023);
        new Chart(document.getElementById('constituency-comparison'), {
            type: 'bar',
            data: {
                labels: data2023.map(d => d.ACNAME),
                datasets: [
                    {
                        label: 'AIMIM',
                        data: data2023.map(d => d.AIMIM_VoteShare),
                        backgroundColor: colors.aimim
                    },
                    {
                        label: 'INC',
                        data: data2023.map(d => d.INC_VoteShare),
                        backgroundColor: colors.inc
                    },
                    {
                        label: 'BJP',
                        data: data2023.map(d => d.BJP_VoteShare),
                        backgroundColor: colors.bjp
                    },
                    {
                        label: 'TRS',
                        data: data2023.map(d => d.TRS_VoteShare),
                        backgroundColor: colors.trs
                    },
                    {
                        label: 'MBT',
                        data: data2023.map(d => d.MBT_VoteShare),
                        backgroundColor: colors.mbt
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        title: {
                            display: true,
                            text: 'Vote Share (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Constituency'
                        }
                    }
                }
            }
        });

        // AIMIM by Constituency
        const constituencies = [...new Set(electionData.map(d => d.ACNAME))].sort();
        const aimimByConstituency = constituencies.map(constituency => {
            const constData = electionData.filter(d => d.ACNAME === constituency && d.AIMIM_VoteShare !== null);
            const avg = constData.reduce((sum, d) => sum + d.AIMIM_VoteShare, 0) / constData.length;
            return avg;
        });

        new Chart(document.getElementById('aimim-constituency'), {
            type: 'bar',
            data: {
                labels: constituencies,
                datasets: [{
                    label: 'Average AIMIM Vote Share (1999-2023)',
                    data: aimimByConstituency,
                    backgroundColor: colors.aimim
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 80,
                        title: {
                            display: true,
                            text: 'Average Vote Share (%)'
                        }
                    }
                }
            }
        });

        // Volatility Analysis
        function calculateVolatility(party) {
            const constituencies = [...new Set(electionData.map(d => d.ACNAME))];
            return constituencies.map(constituency => {
                const values = electionData
                    .filter(d => d.ACNAME === constituency && d[party] !== null)
                    .map(d => d[party]);
                
                if (values.length < 2) return 0;
                
                const mean = values.reduce((a, b) => a + b) / values.length;
                const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
                return Math.sqrt(variance);
            });
        }

        const volatilityData = {
            AIMIM: calculateVolatility('AIMIM_VoteShare'),
            INC: calculateVolatility('INC_VoteShare'),
            BJP: calculateVolatility('BJP_VoteShare'),
            TRS: calculateVolatility('TRS_VoteShare'),
            TDP: calculateVolatility('TDP_VoteShare'),
            MBT: calculateVolatility('MBT_VoteShare')
        };

        new Chart(document.getElementById('volatility-chart'), {
            type: 'bar',
            data: {
                labels: constituencies,
                datasets: [
                    {
                        label: 'AIMIM',
                        data: volatilityData.AIMIM,
                        backgroundColor: colors.aimim
                    },
                    {
                        label: 'INC',
                        data: volatilityData.INC,
                        backgroundColor: colors.inc
                    },
                    {
                        label: 'BJP',
                        data: volatilityData.BJP,
                        backgroundColor: colors.bjp
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Standard Deviation (Volatility Index)'
                        }
                    }
                }
            }
        });

        // Average statistics
        const parties = ['AIMIM_VoteShare', 'INC_VoteShare', 'BJP_VoteShare', 'TRS_VoteShare', 'TDP_VoteShare', 'MBT_VoteShare'];
        const avgStats = document.getElementById('avg-stats');
        
        let statsHTML = '<div class="stats-grid">';
        parties.forEach(party => {
            const values = electionData.filter(d => d[party] !== null).map(d => d[party]);
            if (values.length > 0) {
                const avg = (values.reduce((a, b) => a + b) / values.length).toFixed(2);
                const max = Math.max(...values).toFixed(2);
                const min = Math.min(...values).toFixed(2);
                const partyName = party.replace('_VoteShare', '');
                
                statsHTML += `
                    <div class="stat-card">
                        <h3>${partyName}</h3>
                        <div>Average: <strong>${avg}%</strong></div>
                        <div>Max: <strong>${max}%</strong></div>
                        <div>Min: <strong>${min}%</strong></div>
                    </div>
                `;
            }
        });
        statsHTML += '</div>';
        avgStats.innerHTML = statsHTML;

        // Growth Analysis
        function getGrowthData(party) {
            const constituencies = [...new Set(electionData.map(d => d.ACNAME))];
            return constituencies.map(constituency => {
                const data1999 = electionData.find(d => d.YEAR === 1999 && d.ACNAME === constituency);
                const data2023 = electionData.find(d => d.YEAR === 2023 && d.ACNAME === constituency);
                
                if (data1999 && data2023 && data1999[party] !== null && data2023[party] !== null) {
                    return data2023[party] - data1999[party];
                }
                return null;
            });
        }

        new Chart(document.getElementById('growth-chart'), {
            type: 'bar',
            data: {
                labels: constituencies,
                datasets: [
                    {
                        label: 'AIMIM Growth',
                        data: getGrowthData('AIMIM_VoteShare'),
                        backgroundColor: colors.aimim
                    },
                    {
                        label: 'INC Growth',
                        data: getGrowthData('INC_VoteShare'),
                        backgroundColor: colors.inc
                    },
                    {
                        label: 'BJP Growth',
                        data: getGrowthData('BJP_VoteShare'),
                        backgroundColor: colors.bjp
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Vote Share Change (percentage points)'
                        }
                    }
                }
            }
        });

        // Export functions
        function exportChartToPNG(chartId, filename) {
            const canvas = document.getElementById(chartId);
            const url = canvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = filename;
            link.href = url;
            link.click();
        }

        function exportTableToCSV(tableId, filename) {
            const table = document.getElementById(tableId);
            let csv = [];
            
            // Headers
            const headers = [];
            for (let cell of table.rows[0].cells) {
                headers.push(cell.textContent);
            }
            csv.push(headers.join(','));
            
            // Data
            for (let i = 1; i < table.rows.length; i++) {
                const row = [];
                for (let cell of table.rows[i].cells) {
                    row.push(cell.textContent);
                }
                csv.push(row.join(','));
            }
            
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.download = filename;
            link.href = url;
            link.click();
        }

        function exportAllDataToCSV() {
            let csv = 'YEAR,ACNAME,AIMIM_VoteShare,TDP_VoteShare,MBT_VoteShare,INC_VoteShare,BJP_VoteShare,TRS_VoteShare\n';
            
            electionData.forEach(row => {
                csv += `${row.YEAR},${row.ACNAME},${row.AIMIM_VoteShare || ''},${row.TDP_VoteShare || ''},${row.MBT_VoteShare || ''},${row.INC_VoteShare || ''},${row.BJP_VoteShare || ''},${row.TRS_VoteShare || ''}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.download = 'hyderabad_electoral_data_complete.csv';
            link.href = url;
            link.click();
        }

        function exportToPDF() {
            // Show loading message
            const originalContent = document.querySelector('.container').innerHTML;
            const loadingDiv = document.createElement('div');
            loadingDiv.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 10000; text-align: center;';
            loadingDiv.innerHTML = '<h2 style="color: #667eea; margin-bottom: 10px;">Generating PDF...</h2><p>This may take a moment. Please wait.</p><div style="margin-top: 20px;"><div style="display: inline-block; width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite;"></div></div>';
            
            const style = document.createElement('style');
            style.textContent = '@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }';
            document.head.appendChild(style);
            document.body.appendChild(loadingDiv);
            
            // Use browser print with improved settings
            setTimeout(() => {
                document.body.removeChild(loadingDiv);
                document.head.removeChild(style);
                
                // Trigger print with a slight delay to ensure rendering
                window.print();
            }, 500);
        }
    </script>
</body>
</html>